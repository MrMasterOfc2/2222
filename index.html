<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>INCONNU XD WhatsApp Pairing</title>
  <link rel="stylesheet" href="css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="js/axios.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
      color: #ffffff;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
      overflow-y: auto;
    }

    /* Effet de neige */
    #snow-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .snowflake {
      position: absolute;
      background: #ffffff;
      border-radius: 50%;
      opacity: 0.8;
      filter: blur(1px);
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% {
        transform: translateY(-100px) translateX(0px) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 0.8;
      }
      90% {
        opacity: 0.8;
      }
      100% {
        transform: translateY(100vh) translateX(100px) rotate(360deg);
        opacity: 0;
      }
    }

    /* Étoiles dans le ciel */
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .star {
      position: absolute;
      background: #ffffff;
      border-radius: 50%;
      animation: twinkle 3s infinite alternate;
    }

    @keyframes twinkle {
      0%, 100% {
        opacity: 0.3;
        transform: scale(1);
      }
      50% {
        opacity: 1;
        transform: scale(1.2);
      }
    }

    /* Conteneur principal */
    .container {
      position: relative;
      z-index: 10;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    /* Carte principale */
    .card {
      width: 100%;
      max-width: 480px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 24px;
      padding: 40px 30px;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      animation: slideUp 0.8s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(80px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Bordure animée */
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, #4cc9f0, #4361ee, transparent);
      animation: borderGlow 3s infinite;
    }

    @keyframes borderGlow {
      0%, 100% {
        opacity: 0.5;
      }
      50% {
        opacity: 1;
      }
    }

    /* En-tête */
    .header {
      text-align: center;
      margin-bottom: 35px;
    }

    .logo-container {
      width: 100px;
      height: 100px;
      margin: 0 auto 25px;
      position: relative;
    }

    .logo-ring {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 3px solid transparent;
      border-top-color: #4cc9f0;
      border-right-color: #4361ee;
      border-radius: 50%;
      animation: spin 8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .logo {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 42px;
      color: white;
      box-shadow: 
        0 10px 40px rgba(76, 201, 240, 0.4),
        inset 0 0 20px rgba(255, 255, 255, 0.3);
      position: relative;
      z-index: 2;
    }

    .title {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
      letter-spacing: 1px;
    }

    .subtitle {
      font-size: 15px;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 400;
      letter-spacing: 0.5px;
    }

    /* Section serveur */
    .server-section {
      margin-bottom: 25px;
    }

    .server-info {
      background: linear-gradient(135deg, rgba(67, 97, 238, 0.15) 0%, rgba(76, 201, 240, 0.15) 100%);
      border: 1px solid rgba(76, 201, 240, 0.3);
      border-radius: 18px;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 15px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .server-info::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.7s;
    }

    .server-info:hover::before {
      left: 100%;
    }

    .server-info:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(76, 201, 240, 0.2);
      border-color: rgba(76, 201, 240, 0.5);
    }

    .server-info.server-full {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.15) 0%, rgba(238, 90, 90, 0.15) 100%);
      border-color: rgba(255, 107, 107, 0.3);
      animation: pulseFull 2s infinite;
    }

    @keyframes pulseFull {
      0%, 100% {
        border-color: rgba(255, 107, 107, 0.3);
      }
      50% {
        border-color: rgba(255, 107, 107, 0.6);
      }
    }

    .server-info-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .server-info-left i {
      color: #4cc9f0;
      font-size: 24px;
      background: rgba(255, 255, 255, 0.1);
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .server-info.server-full .server-info-left i {
      color: #ff6b6b;
    }

    .server-details {
      flex: 1;
    }

    .server-name {
      display: block;
      font-weight: 700;
      font-size: 16px;
      margin-bottom: 6px;
      color: #ffffff;
    }

    .server-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.8);
    }

    .server-stat {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .server-stat i {
      font-size: 10px;
    }

    .change-server-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 10px 18px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
    }

    .change-server-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    /* Sélection serveur */
    .server-selection {
      display: none;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(76, 201, 240, 0.2);
      border-radius: 18px;
      padding: 20px;
      margin-top: 15px;
      max-height: 300px;
      overflow-y: auto;
      backdrop-filter: blur(20px);
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .server-selection-title {
      font-size: 17px;
      font-weight: 700;
      margin-bottom: 15px;
      color: #ffffff;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .server-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .server-option {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 14px;
      padding: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .server-option:hover {
      background: rgba(76, 201, 240, 0.1);
      border-color: rgba(76, 201, 240, 0.3);
      transform: translateY(-3px);
    }

    .server-option.selected {
      background: rgba(76, 201, 240, 0.15);
      border-color: #4cc9f0;
      box-shadow: 0 5px 20px rgba(76, 201, 240, 0.2);
    }

    .server-option.disabled {
      opacity: 0.5;
      cursor: not-allowed;
      background: rgba(255, 107, 107, 0.05);
      border-color: rgba(255, 107, 107, 0.2);
    }

    .server-option.disabled:hover {
      transform: none;
      background: rgba(255, 107, 107, 0.05);
      border-color: rgba(255, 107, 107, 0.2);
    }

    .server-option-name {
      font-weight: 600;
      font-size: 15px;
      color: #ffffff;
      margin-bottom: 4px;
    }

    .server-option-stats {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
    }

    .server-option-capacity {
      font-size: 11px;
      color: #4cc9f0;
      font-weight: 600;
      margin-top: 4px;
    }

    .server-option-full {
      color: #ff6b6b;
    }

    /* Boîte d'info */
    .info-box {
      background: linear-gradient(135deg, rgba(76, 201, 240, 0.1) 0%, rgba(67, 97, 238, 0.1) 100%);
      border: 1px solid rgba(76, 201, 240, 0.3);
      border-radius: 18px;
      padding: 22px;
      margin-bottom: 25px;
      display: flex;
      align-items: flex-start;
      gap: 15px;
      position: relative;
      overflow: hidden;
    }

    .info-box i {
      color: #4cc9f0;
      font-size: 22px;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .info-box-text {
      flex: 1;
    }

    .info-box-text strong {
      display: block;
      margin-bottom: 8px;
      font-size: 16px;
      font-weight: 700;
      color: #ffffff;
    }

    .info-box-text p {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.6;
    }

    /* Sessions */
    .sessions-list {
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 18px;
      padding: 20px;
      margin-top: 20px;
      max-height: 220px;
      overflow-y: auto;
      backdrop-filter: blur(10px);
    }

    .sessions-title {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 15px;
      color: #ffffff;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .session-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .session-item:last-child {
      border-bottom: none;
    }

    .session-id {
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.9);
      font-weight: 500;
    }

    .session-status {
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
    }

    .status-running {
      background: rgba(0, 212, 170, 0.2);
      color: #00d4aa;
    }

    .status-stopped {
      background: rgba(255, 107, 107, 0.2);
      color: #ff6b6b;
    }

    .refresh-sessions {
      background: transparent;
      border: none;
      color: #4cc9f0;
      cursor: pointer;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: 8px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }

    .refresh-sessions:hover {
      background: rgba(76, 201, 240, 0.1);
      transform: rotate(90deg);
    }

    /* Formulaire */
    .form-group {
      margin-bottom: 25px;
    }

    .label {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
      font-size: 15px;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .label i {
      color: #4cc9f0;
    }

    .input-wrapper {
      position: relative;
    }

    .input-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.5);
      font-size: 20px;
    }

    .input {
      width: 100%;
      padding: 18px 20px 18px 60px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      color: white;
      font-size: 16px;
      font-family: inherit;
      transition: all 0.3s ease;
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    .input:focus {
      outline: none;
      border-color: #4cc9f0;
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 0 0 0 4px rgba(76, 201, 240, 0.15);
    }

    .input:focus + .input-icon {
      color: #4cc9f0;
    }

    .input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }

    .hint {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hint i {
      color: #4cc9f0;
      font-size: 12px;
    }

    /* Boutons */
    .btn {
      width: 100%;
      padding: 18px;
      border: none;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      letter-spacing: 0.5px;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.7s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-generate {
      background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
      color: white;
      box-shadow: 0 10px 30px rgba(76, 201, 240, 0.3);
      margin-bottom: 15px;
    }

    .btn-generate:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(76, 201, 240, 0.5);
    }

    .btn-generate:active:not(:disabled) {
      transform: translateY(-2px);
    }

    .btn-generate:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
    }

    .btn-copy {
      background: rgba(255, 255, 255, 0.08);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: none;
      backdrop-filter: blur(10px);
    }

    .btn-copy:hover {
      background: rgba(255, 255, 255, 0.12);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    /* Loading */
    .loading {
      display: none;
      text-align: center;
      margin: 20px 0;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(76, 201, 240, 0.2);
      border-radius: 50%;
      border-top-color: #4cc9f0;
      animation: spin 1.2s linear infinite;
      margin: 0 auto 15px;
    }

    .loading-text {
      color: rgba(255, 255, 255, 0.7);
      font-size: 15px;
      font-weight: 500;
    }

    /* Code box */
    .code-box {
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 18px;
      padding: 22px;
      text-align: center;
      margin-bottom: 15px;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.4s ease;
      backdrop-filter: blur(10px);
    }

    .code-box.has-code {
      border-color: rgba(0, 212, 170, 0.5);
      background: rgba(0, 212, 170, 0.05);
      box-shadow: 0 10px 30px rgba(0, 212, 170, 0.1);
    }

    .code-box.has-error {
      border-color: rgba(255, 107, 107, 0.5);
      background: rgba(255, 107, 107, 0.05);
    }

    .code-placeholder {
      color: rgba(255, 255, 255, 0.5);
      font-size: 15px;
      font-weight: 500;
    }

    .code-value {
      font-size: 26px;
      font-weight: 800;
      letter-spacing: 3px;
      color: #00d4aa;
      font-family: 'Courier New', monospace;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .code-value i {
      font-size: 24px;
    }

    .error-value {
      color: #ff6b6b;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
    }

    /* Section alternative */
    .alternative-box {
      background: linear-gradient(135deg, rgba(118, 75, 162, 0.15) 0%, rgba(245, 87, 108, 0.15) 100%);
      border: 1px solid rgba(118, 75, 162, 0.3);
      border-radius: 18px;
      padding: 22px;
      margin: 25px 0;
      position: relative;
      overflow: hidden;
    }

    .alternative-box i {
      color: #764ba2;
      font-size: 22px;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .alternative-text {
      flex: 1;
    }

    .alternative-text strong {
      display: block;
      margin-bottom: 10px;
      font-size: 16px;
      font-weight: 700;
      color: #ffffff;
    }

    .alternative-text p {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .alternative-links {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 10px;
    }

    .alt-link-btn {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      padding: 12px 20px;
      color: white;
      text-decoration: none;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 150px;
      justify-content: center;
      font-weight: 600;
      backdrop-filter: blur(10px);
    }

    .alt-link-btn:hover {
      background: rgba(118, 75, 162, 0.3);
      transform: translateY(-3px);
      border-color: rgba(118, 75, 162, 0.5);
      box-shadow: 0 10px 25px rgba(118, 75, 162, 0.2);
    }

    .alt-link-btn i {
      font-size: 18px;
      margin: 0;
    }

    /* Liens sociaux */
    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      padding-top: 25px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
      text-decoration: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .social-link::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.7s;
    }

    .social-link:hover::before {
      left: 100%;
    }

    .social-link:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
    }

    .social-link.whatsapp:hover {
      background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    }

    .social-link.youtube:hover {
      background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
    }

    .social-link.telegram:hover {
      background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
    }

    .social-link.group:hover {
      background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
    }

    /* Footer */
    .footer {
      text-align: center;
      margin-top: 25px;
      padding-top: 25px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .footer-text {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 5px;
      font-weight: 500;
    }

    .footer-text.highlight {
      color: #4cc9f0;
      font-weight: 600;
    }

    .dev-name {
      color: #f5576c;
      font-weight: 700;
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(150px);
      background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
      color: white;
      padding: 16px 28px;
      border-radius: 50px;
      font-weight: 600;
      box-shadow: 0 15px 40px rgba(0, 212, 170, 0.4);
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 1000;
      opacity: 0;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 15px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .toast.error {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
    }

    /* Full server warning */
    .server-full-warning {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(238, 90, 90, 0.1) 100%);
      border: 1px solid rgba(255, 107, 107, 0.3);
      border-radius: 12px;
      padding: 12px 16px;
      margin-top: 10px;
      font-size: 13px;
      color: #ff6b6b;
      display: flex;
      align-items: center;
      gap: 10px;
      animation: fadeIn 0.5s ease;
    }

    .server-full-warning i {
      font-size: 16px;
    }

    /* Scrollbar personnalisée */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(76, 201, 240, 0.5);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(76, 201, 240, 0.7);
    }

    /* Responsive */
    @media (max-width: 580px) {
      .card {
        padding: 35px 20px;
        border-radius: 20px;
        max-width: 95%;
      }

      .title {
        font-size: 28px;
      }

      .logo-container {
        width: 85px;
        height: 85px;
        margin-bottom: 20px;
      }

      .logo {
        font-size: 36px;
      }

      .code-value {
        font-size: 22px;
      }

      .alt-link-btn {
        min-width: 100%;
      }

      .social-link {
        width: 45px;
        height: 45px;
        font-size: 18px;
      }

      .server-info {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .change-server-btn {
        width: 100%;
        justify-content: center;
      }

      .server-stats {
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Conteneur de neige -->
  <div id="snow-container"></div>
  
  <!-- Étoiles dans le ciel -->
  <div class="stars" id="stars"></div>

  <div class="container">
    <div class="card">
      <div class="header">
        <div class="logo-container">
          <div class="logo-ring"></div>
          <div class="logo">
            <i class="fas fa-snowflake"></i>
          </div>
        </div>
        <h1 class="title">INCONNU XD LITE</h1>
        <p class="subtitle">WhatsApp Pairing System</p>
      </div>

      <!-- Section Serveur -->
      <div class="server-section">
        <div class="server-info" id="serverInfo">
          <div class="server-info-left">
            <i class="fas fa-server"></i>
            <div class="server-details">
              <span class="server-name" id="currentServerName">Primary Server</span>
              <div class="server-stats">
                <span class="server-stat" id="activeCount">
                  <i class="fas fa-circle" style="color: #00d4aa;"></i>
                  Active: --
                </span>
                <span class="server-stat" id="serverStatus">
                  <i class="fas fa-signal"></i>
                  Status: --
                </span>
                <span class="server-stat" id="serverCapacity">
                  <i class="fas fa-users"></i>
                  Capacity: --
                </span>
              </div>
            </div>
          </div>
          <div class="change-server-btn" id="changeServerBtn">
            <i class="fas fa-exchange-alt"></i>
            Change Server
          </div>
        </div>

        <!-- Avertissement serveur plein -->
        <div id="serverFullWarning" class="server-full-warning" style="display: none;">
          <i class="fas fa-exclamation-triangle"></i>
          <span>This server is FULL! Click "Change Server" or wait for auto-switch.</span>
        </div>

        <div class="server-selection" id="serverSelection">
          <div class="server-selection-title">
            <i class="fas fa-server"></i>
            Select Server
          </div>
          <div class="server-grid" id="serverGrid">
            <!-- Les serveurs seront ajoutés dynamiquement -->
          </div>
        </div>
      </div>

      <div class="sessions-list">
        <div class="sessions-title">
          <span><i class="fas fa-list"></i> Active Sessions</span>
          <button class="refresh-sessions" id="refreshSessionsBtn">
            <i class="fas fa-redo-alt"></i>
          </button>
        </div>
        <div id="sessionsContainer">
          <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.5);">
            <i class="fas fa-spinner fa-spin"></i> Loading sessions...
          </div>
        </div>
      </div>

      <div class="info-box">
        <i class="fas fa-info-circle"></i>
        <div class="info-box-text">
          <strong>How to Pair WhatsApp</strong>
          <p>Enter your WhatsApp number (without +), click Generate, then use the code in WhatsApp → Linked Devices → Link a device → Pair using code</p>
        </div>
      </div>

      <form id="pairForm">
        <div class="form-group">
          <label class="label">
            <i class="fas fa-mobile-alt"></i>
            WhatsApp Number
          </label>
          <div class="input-wrapper">
            <input type="tel" id="phoneNumber" class="input" placeholder="5511999999999" pattern="[0-9]+" required="">
            <i class="fas fa-phone-alt input-icon"></i>
          </div>
          <div class="hint">
            <i class="fas fa-lightbulb"></i>
            Enter without + (e.g., 5511999999999 for Brazil, 92342758xxxxx for Pakistan)
          </div>
        </div>

        <button type="submit" class="btn btn-generate" id="generateBtn">
          <i class="fas fa-key"></i>
          Generate Pair Code
        </button>

        <div class="loading" id="loading">
          <div class="spinner"></div>
          <p class="loading-text">Generating your pair code...</p>
        </div>

        <div class="code-box" id="codeBox">
          <div class="code-placeholder">Your pairing code will appear here</div>
        </div>

        <button type="button" class="btn btn-copy" id="copyBtn">
          <i class="fas fa-copy"></i>
          Copy Code
        </button>
      </form>

      <div class="alternative-box">
        <i class="fas fa-robot"></i>
        <div class="alternative-text">
          <strong>Alternative Pairing Methods</strong>
          <p>If you can't pair here, use these alternative methods:</p>
          <div class="alternative-links">
            <a href="https://t.me/queen_akuma_bot" target="_blank" class="alt-link-btn">
              <i class="fab fa-telegram"></i>
              Telegram Bot
            </a>
            <a href="https://t.me/+f5MXTmwwdeU2Y2Ux" target="_blank" class="alt-link-btn">
              <i class="fas fa-users"></i>
              Telegram Group
            </a>
          </div>
        </div>
      </div>

      <div class="social-links">
        <a href="https://whatsapp.com/channel/0029VbC6It7K0IBkQwaKYd2J" target="_blank" class="social-link whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
        <a href="https://chat.whatsapp.com/HVdyhSroS6h3HoCbankB8X" target="_blank" class="social-link group">
          <i class="fas fa-comments"></i>
        </a>
        <a href="https://youtu.be/n09eZbKexQY?si=r_n6K596sdT6l0Qe" target="_blank" class="social-link youtube">
          <i class="fab fa-youtube"></i>
        </a>
        <a href="https://t.me/+f5MXTmwwdeU2Y2Ux" target="_blank" class="social-link telegram">
          <i class="fab fa-telegram"></i>
        </a>
      </div>

      <div class="footer">
        <p class="footer-text">
          © 2026 INCONNU XD | <span id="backendUrl" class="highlight">Server: Primary</span>
        </p>
        <p class="footer-text">
          Created with <i class="fas fa-heart" style="color: #f5576c;"></i> by <span class="dev-name">Dev Inconnu Boy</span>
        </p>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span>Code copied successfully</span>
  </div>

  <script>
    // Configuration des serveurs avec limite de 25 sessions
    const SERVERS = [
      {
        id: 'server1',
        name: 'Primary Server',
        url: 'https://hqh-production.up.railway.app',
        description: 'Main Server (Stable)',
        icon: 'fas fa-shield-alt',
        maxSessions: 25,
        activeSessions: 0,
        isFull: false,
        priority: 1
      },
      {
        id: 'server2',
        name: 'Server 2',
        url: 'https://me-production-1cab.up.railway.app',
        description: 'Backup Server 1',
        icon: 'fas fa-backup',
        maxSessions: 25,
        activeSessions: 0,
        isFull: false,
        priority: 2
      },
      {
        id: 'server3',
        name: 'Server 3',
        url: 'https://test-production-9a07.up.railway.app',
        description: 'Backup Server 2',
        icon: 'fas fa-server',
        maxSessions: 25,
        activeSessions: 0,
        isFull: false,
        priority: 3
      }
    ];

    // État de l'application
    let currentServer = SERVERS[0];
    let currentCode = null;
    let serverSelectionVisible = false;
    let autoSwitchTimeout = null;

    // DOM Elements
    const phoneInput = document.getElementById('phoneNumber');
    const generateBtn = document.getElementById('generateBtn');
    const loading = document.getElementById('loading');
    const codeBox = document.getElementById('codeBox');
    const copyBtn = document.getElementById('copyBtn');
    const toast = document.getElementById('toast');
    const form = document.getElementById('pairForm');
    const serverInfo = document.getElementById('serverInfo');
    const serverFullWarning = document.getElementById('serverFullWarning');
    const currentServerName = document.getElementById('currentServerName');
    const activeCount = document.getElementById('activeCount');
    const serverStatus = document.getElementById('serverStatus');
    const serverCapacity = document.getElementById('serverCapacity');
    const sessionsContainer = document.getElementById('sessionsContainer');
    const refreshSessionsBtn = document.getElementById('refreshSessionsBtn');
    const backendUrlSpan = document.getElementById('backendUrl');
    const changeServerBtn = document.getElementById('changeServerBtn');
    const serverSelection = document.getElementById('serverSelection');
    const serverGrid = document.getElementById('serverGrid');
    const snowContainer = document.getElementById('snow-container');
    const starsContainer = document.getElementById('stars');

    // Créer l'effet de neige
    function createSnow() {
      const snowflakeCount = 80;
      
      for (let i = 0; i < snowflakeCount; i++) {
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        
        // Taille aléatoire
        const size = Math.random() * 10 + 5;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        
        // Position de départ aléatoire
        snowflake.style.left = `${Math.random() * 100}vw`;
        
        // Opacité aléatoire
        snowflake.style.opacity = Math.random() * 0.7 + 0.3;
        
        // Durée d'animation aléatoire
        const duration = Math.random() * 10 + 10;
        snowflake.style.animationDuration = `${duration}s`;
        
        // Délai d'animation aléatoire
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        
        snowContainer.appendChild(snowflake);
      }
    }

    // Créer les étoiles
    function createStars() {
      const starCount = 100;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.classList.add('star');
        
        // Taille aléatoire
        const size = Math.random() * 3 + 1;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        
        // Position aléatoire
        star.style.left = `${Math.random() * 100}vw`;
        star.style.top = `${Math.random() * 100}vh`;
        
        // Délai d'animation aléatoire
        star.style.animationDelay = `${Math.random() * 3}s`;
        
        starsContainer.appendChild(star);
      }
    }

    // Sélection automatique du meilleur serveur
    function selectBestServer() {
      // Filtrer les serveurs qui ne sont pas pleins
      const availableServers = SERVERS.filter(server => !server.isFull);
      
      if (availableServers.length === 0) {
        // Tous les serveurs sont pleins, on prend celui avec le moins d'utilisateurs
        const sortedByLoad = [...SERVERS].sort((a, b) => a.activeSessions - b.activeSessions);
        return sortedByLoad[0];
      }
      
      // Trier par priorité (serveur principal d'abord)
      const sortedByPriority = [...availableServers].sort((a, b) => a.priority - b.priority);
      return sortedByPriority[0];
    }

    // Initialiser l'application
    async function initApp() {
      // Créer les effets visuels
      createSnow();
      createStars();
      
      // Charger le serveur depuis le localStorage s'il existe
      const savedServerId = localStorage.getItem('selectedServerId');
      if (savedServerId) {
        const savedServer = SERVERS.find(s => s.id === savedServerId);
        if (savedServer) {
          currentServer = savedServer;
        }
      }
      
      // Vérifier si le serveur sauvegardé est le meilleur choix
      const bestServer = selectBestServer();
      if (bestServer.id !== currentServer.id && bestServer.priority < currentServer.priority) {
        // Basculer automatiquement vers un meilleur serveur
        setTimeout(() => {
          selectServer(bestServer.id);
          showToast(`Auto-switched to ${bestServer.name} for better performance`, false);
        }, 1500);
      }
      
      // Mettre à jour l'affichage du serveur
      updateServerDisplay();
      
      // Initialiser la grille des serveurs
      initServerGrid();
      
      // Charger les données initiales
      await loadSessions();
      await checkServerStatus();
      
      // Ajouter les écouteurs d'événements
      changeServerBtn.addEventListener('click', toggleServerSelection);
      serverInfo.addEventListener('click', () => {
        if (!serverSelectionVisible) {
          checkServerStatus();
        }
      });
      refreshSessionsBtn.addEventListener('click', loadSessions);
      
      // Activer le bouton de génération
      generateBtn.disabled = false;
    }

    // Initialiser la grille des serveurs
    function initServerGrid() {
      serverGrid.innerHTML = '';
      
      SERVERS.forEach(server => {
        const serverElement = document.createElement('div');
        serverElement.className = `server-option ${server.id === currentServer.id ? 'selected' : ''} ${server.isFull ? 'disabled' : ''}`;
        serverElement.setAttribute('data-server-id', server.id);
        
        serverElement.innerHTML = `
          <div>
            <div class="server-option-name">
              <i class="${server.icon}" style="margin-right: 8px; color: ${server.isFull ? '#ff6b6b' : '#4cc9f0'};"></i>
              ${server.name}
            </div>
            <div class="server-option-stats">${server.description}</div>
            <div class="server-option-capacity ${server.isFull ? 'server-option-full' : ''}">
              ${server.activeSessions}/${server.maxSessions} sessions ${server.isFull ? ' (FULL)' : ''}
            </div>
          </div>
          <i class="fas fa-check-circle" style="color: #00d4aa; ${server.id === currentServer.id ? '' : 'display: none'}"></i>
        `;
        
        if (!server.isFull) {
          serverElement.addEventListener('click', () => selectServer(server.id));
        }
        serverGrid.appendChild(serverElement);
      });
    }

    // Basculer l'affichage de la sélection des serveurs
    function toggleServerSelection() {
      serverSelectionVisible = !serverSelectionVisible;
      if (serverSelectionVisible) {
        serverSelection.style.display = 'block';
        changeServerBtn.innerHTML = '<i class="fas fa-times"></i> Close';
      } else {
        serverSelection.style.display = 'none';
        changeServerBtn.innerHTML = '<i class="fas fa-exchange-alt"></i> Change Server';
      }
    }

    // Sélectionner un serveur
    async function selectServer(serverId) {
      const selectedServer = SERVERS.find(s => s.id === serverId);
      if (!selectedServer || selectedServer.id === currentServer.id) {
        return;
      }

      // Mettre à jour le serveur courant
      currentServer = selectedServer;
      localStorage.setItem('selectedServerId', serverId);
      
      // Mettre à jour l'affichage
      updateServerDisplay();
      
      // Mettre à jour la grille
      document.querySelectorAll('.server-option').forEach(option => {
        const optionServerId = option.getAttribute('data-server-id');
        const checkIcon = option.querySelector('.fa-check-circle');
        
        if (optionServerId === serverId) {
          option.classList.add('selected');
          checkIcon.style.display = 'block';
        } else {
          option.classList.remove('selected');
          checkIcon.style.display = 'none';
        }
      });
      
      // Fermer la sélection
      toggleServerSelection();
      
      // Vérifier le statut et charger les sessions
      await checkServerStatus();
      await loadSessions();
      
      showToast(`Switched to ${selectedServer.name}`, false);
      
      // Annuler le timeout d'auto-switch s'il existe
      if (autoSwitchTimeout) {
        clearTimeout(autoSwitchTimeout);
        autoSwitchTimeout = null;
      }
    }

    // Mettre à jour l'affichage du serveur
    function updateServerDisplay() {
      currentServerName.textContent = currentServer.name;
      backendUrlSpan.textContent = `Server: ${currentServer.name.replace(' Server', '')}`;
      
      // Mettre à jour la capacité
      const capacityText = `Capacity: ${currentServer.activeSessions}/${currentServer.maxSessions}`;
      serverCapacity.innerHTML = `<i class="fas fa-users" style="color:${currentServer.isFull ? '#ff6b6b' : '#00d4aa'}"></i> ${capacityText}`;
      
      // Mettre à jour le style du serveur
      if (currentServer.isFull) {
        serverInfo.classList.add('server-full');
        serverFullWarning.style.display = 'flex';
        generateBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i> Server Full - Switch Server';
      } else {
        serverInfo.classList.remove('server-full');
        serverFullWarning.style.display = 'none';
        generateBtn.innerHTML = '<i class="fas fa-key"></i> Generate Pair Code';
      }
      
      // Désactiver le bouton si le serveur est plein
      generateBtn.disabled = currentServer.isFull;
    }

    // Mettre à jour l'état des serveurs basé sur les sessions actives
    function updateServerStatus(sessions) {
      const runningSessions = sessions.filter(s => s.running).length;
      
      // Mettre à jour le compteur du serveur actuel
      currentServer.activeSessions = runningSessions;
      
      // Vérifier si le serveur actuel est plein
      const wasFull = currentServer.isFull;
      currentServer.isFull = runningSessions >= currentServer.maxSessions;
      
      // Si le serveur vient de devenir plein
      if (currentServer.isFull && !wasFull) {
        showToast(`${currentServer.name} is now FULL! Auto-switching in 5 seconds...`, true);
        
        // Planifier le changement automatique
        scheduleAutoSwitch();
      }
      
      // Si le serveur n'est plus plein
      if (!currentServer.isFull && wasFull) {
        showToast(`${currentServer.name} now has available slots!`, false);
        
        // Annuler l'auto-switch
        if (autoSwitchTimeout) {
          clearTimeout(autoSwitchTimeout);
          autoSwitchTimeout = null;
        }
      }
      
      // Mettre à jour l'affichage
      updateServerDisplay();
      initServerGrid();
    }

    // Planifier le changement automatique de serveur
    function scheduleAutoSwitch() {
      // Annuler le timeout précédent s'il existe
      if (autoSwitchTimeout) {
        clearTimeout(autoSwitchTimeout);
      }
      
      // Planifier le changement automatique après 5 secondes
      autoSwitchTimeout = setTimeout(() => {
        if (currentServer.isFull) {
          const bestServer = selectBestServer();
          
          if (bestServer.id !== currentServer.id) {
            selectServer(bestServer.id);
            showToast(`Auto-switched to ${bestServer.name}`, false);
          } else {
            showToast('All servers are full. Please try again later.', true);
          }
        }
      }, 5000);
    }

    // Charger les sessions depuis le backend
    async function loadSessions() {
      try {
        refreshSessionsBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        const response = await axios.get(`${currentServer.url}/sessions`, {
          timeout: 10000
        });
        const sessions = response.data.sessions || [];
        
        displaySessions(sessions);
        
        // Mettre à jour le statut du serveur avec les sessions récupérées
        updateServerStatus(sessions);
        
        // Mettre à jour le compteur actif
        const runningSessions = sessions.filter(s => s.running).length;
        activeCount.innerHTML = `<i class="fas fa-circle" style="color:#00d4aa;"></i> Active: ${runningSessions}`;
        
        refreshSessionsBtn.innerHTML = '<i class="fas fa-redo-alt"></i>';
        
        // Retourner les sessions pour utilisation ultérieure
        return sessions;
        
      } catch (error) {
        console.error('Error loading sessions:', error);
        sessionsContainer.innerHTML = `
          <div style="text-align: center; padding: 20px; color: #ff6b6b;">
            <i class="fas fa-exclamation-circle"></i> Failed to load sessions
          </div>
        `;
        refreshSessionsBtn.innerHTML = '<i class="fas fa-redo-alt"></i>';
        
        // En cas d'erreur, considérer le serveur comme hors ligne
        serverStatus.innerHTML = `<i class="fas fa-signal" style="color:#ff6b6b;"></i> Status: Offline`;
        currentServerName.textContent = `${currentServer.name} ✗`;
        
        // Essayer de basculer automatiquement sur un autre serveur
        const bestServer = selectBestServer();
        if (bestServer.id !== currentServer.id) {
          showToast(`${currentServer.name} is offline! Auto-switching to ${bestServer.name}`, true);
          
          currentServer = bestServer;
          localStorage.setItem('selectedServerId', currentServer.id);
          
          updateServerDisplay();
          initServerGrid();
          
          // Recharger après un délai
          setTimeout(() => loadSessions(), 1500);
        }
        
        return [];
      }
    }

    // Afficher les sessions dans la liste
    function displaySessions(sessions) {
      if (sessions.length === 0) {
        sessionsContainer.innerHTML = `
          <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.5);">
            <i class="fas fa-inbox"></i> No active sessions
          </div>
        `;
        return;
      }
      
      let html = '';
      sessions.forEach(session => {
        const isRunning = session.running || false;
        const sessionId = session.id || 'Unknown';
        
        html += `
          <div class="session-item">
            <span class="session-id">${sessionId}</span>
            <span class="session-status ${isRunning ? 'status-running' : 'status-stopped'}">
              ${isRunning ? 'Running' : 'Stopped'}
            </span>
          </div>
        `;
      });
      
      sessionsContainer.innerHTML = html;
    }

    // Vérifier le statut du serveur
    async function checkServerStatus() {
      try {
        serverInfo.style.opacity = '0.8';
        
        const response = await axios.get(currentServer.url, {
          timeout: 8000
        });
        serverStatus.innerHTML = `<i class="fas fa-signal" style="color:#00d4aa;"></i> Status: Online`;
        currentServerName.textContent = `${currentServer.name} ✓`;
        
        // Actualiser également les sessions
        await loadSessions();
        
      } catch (error) {
        console.error('Error checking server:', error);
        serverStatus.innerHTML = `<i class="fas fa-signal" style="color:#ff6b6b;"></i> Status: Offline`;
        currentServerName.textContent = `${currentServer.name} ✗`;
        
        sessionsContainer.innerHTML = `
          <div style="text-align: center; padding: 20px; color: #ff6b6b;">
            <i class="fas fa-exclamation-circle"></i> Cannot connect to server
          </div>
        `;
        
        showToast(`Cannot connect to ${currentServer.name}`, true);
      } finally {
        serverInfo.style.opacity = '1';
      }
    }

    // Notification Toast
    function showToast(message, isError = false) {
      const toastIcon = toast.querySelector('i');
      const toastText = toast.querySelector('span');
      
      toastIcon.className = isError ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
      toastText.textContent = message;
      toast.className = `toast ${isError ? 'error' : ''} show`;
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Validation du téléphone
    function validatePhone(number) {
      const cleaned = number.replace(/[^\d]/g, '');
      return cleaned.length >= 6 && cleaned.length <= 15 && /^\d+$/.test(cleaned);
    }

    // Afficher une erreur dans la boîte de code
    function showError(message) {
      codeBox.className = 'code-box has-error';
      codeBox.innerHTML = `
        <div class="error-value">
          <i class="fas fa-exclamation-circle"></i>
          <span>${message}</span>
        </div>
      `;
      copyBtn.style.display = 'none';
    }

    // Afficher le code généré
    function showCode(code) {
      currentCode = code;
      codeBox.className = 'code-box has-code';
      codeBox.innerHTML = `
        <div class="code-value">
          <i class="fas fa-check-circle"></i>
          <span>${code}</span>
        </div>
      `;
      copyBtn.style.display = 'flex';
    }

    // Réinitialiser la boîte de code
    function resetCodeBox() {
      codeBox.className = 'code-box';
      codeBox.innerHTML = '<div class="code-placeholder">Your pairing code will appear here</div>';
      copyBtn.style.display = 'none';
      currentCode = null;
    }

    // Générer un code d'appariement via l'API backend
    async function generatePairCode(e) {
      e.preventDefault();
      
      // Vérifier si le serveur est plein AVANT de procéder
      if (currentServer.isFull) {
        const bestServer = selectBestServer();
        
        if (bestServer.id !== currentServer.id) {
          // Demander à l'utilisateur de basculer
          showError(`Server is full (${currentServer.activeSessions}/${currentServer.maxSessions} sessions). Click "Change Server" or we'll auto-switch in 5 seconds.`);
          showToast('Server is full. Switching automatically...', true);
          
          // Ouvrir la sélection des serveurs
          if (!serverSelectionVisible) {
            toggleServerSelection();
          }
          
          // Basculer automatiquement après 5 secondes
          setTimeout(() => {
            if (currentServer.isFull) {
              selectServer(bestServer.id);
              showToast(`Auto-switched to ${bestServer.name}`, false);
            }
          }, 5000);
        } else {
          showError(`All servers are currently full (${currentServer.activeSessions}/${currentServer.maxSessions} sessions). Please try again later.`);
          showToast('All servers are full. Please wait...', true);
        }
        
        return;
      }
      
      const phoneNumber = phoneInput.value.trim();
      
      if (!phoneNumber) {
        showError('Please enter your WhatsApp number');
        showToast('Phone number is required', true);
        return;
      }
      
      if (!validatePhone(phoneNumber)) {
        showError('Please enter a valid phone number (6-15 digits, no +)');
        showToast('Invalid phone number format', true);
        return;
      }
      
      // Afficher l'état de chargement
      generateBtn.style.display = 'none';
      loading.style.display = 'block';
      resetCodeBox();
      
      try {
        // Appeler l'API backend pour l'appariement
        const response = await axios.get(`${currentServer.url}/pair/${phoneNumber}`, {
          timeout: 60000,
        });
        
        if (response.data.ok && response.data.code) {
          showCode(response.data.code);
          showToast('Pair code generated successfully!');
          
          // Essayer également de démarrer la session
          try {
            await axios.get(`${currentServer.url}/start/${phoneNumber}`, {
              timeout: 10000,
            });
          } catch (startError) {
            console.log('Session may already be started:', startError.message);
          }
          
          // Actualiser la liste des sessions pour mettre à jour le compteur
          await loadSessions();
        } else {
          throw new Error(response.data.error || 'Failed to generate code');
        }
        
      } catch (error) {
        console.error('Error generating code:', error);
        
        let errorMessage = 'Failed to generate code';
        if (error.response?.data?.error) {
          errorMessage = error.response.data.error;
        } else if (error.message) {
          errorMessage = error.message;
        }
        
        showError(errorMessage);
        showToast('Error generating code', true);
      } finally {
        // Restaurer l'état du bouton
        generateBtn.style.display = 'flex';
        loading.style.display = 'none';
      }
    }

    // Copier le code dans le presse-papiers
    async function copyCode() {
      if (!currentCode) return;
      
      try {
        await navigator.clipboard.writeText(currentCode);
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
        copyBtn.disabled = true;
        copyBtn.style.opacity = '0.7';
        
        showToast('Code copied to clipboard!');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.disabled = false;
          copyBtn.style.opacity = '1';
        }, 2000);
        
      } catch (error) {
        console.error('Copy failed:', error);
        showToast('Failed to copy code', true);
      }
    }

    // Écouteurs d'événements
    form.addEventListener('submit', generatePairCode);
    copyBtn.addEventListener('click', copyCode);

    phoneInput.addEventListener('input', (e) => {
      e.target.value = e.target.value.replace(/[^\d]/g, '');
    });

    phoneInput.addEventListener('focus', () => {
      if (codeBox.classList.contains('has-error')) {
        resetCodeBox();
      }
    });

    // Gérer les clics en dehors de la sélection du serveur
    document.addEventListener('click', (e) => {
      if (serverSelectionVisible && 
          !serverSelection.contains(e.target) && 
          !changeServerBtn.contains(e.target) &&
          !serverInfo.contains(e.target)) {
        toggleServerSelection();
      }
    });

    // Initialiser l'application
    document.addEventListener('DOMContentLoaded', initApp);
  </script>


</body></html>
